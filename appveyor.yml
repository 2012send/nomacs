image: Visual Studio 2019
configuration: Release
skip_commits:
  files:
    - '.github/*'
    - '.travis.yml'
    - '.gitignore'
    - '*.md'

environment:
    matrix:
    - PLATFORM: x86
      QT5: C:\Qt\5.14.1\msvc2017
    - PLATFORM: x86_amd64
      QT5: C:\Qt\5.14.1\msvc2017_64

install:
 - git submodule update --init --recursive
 - call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvars64.bat"
 # my machine:
 #  - call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\VC\Auxiliary\Build\vcvars64.bat"
 - cd ImageLounge
 - mkdir build
 - cd build
 - cmake -DENABLE_TRANSLATIONS=ON -DCMAKE_PREFIX_PATH=%QT5% ..
 
build:
  project: build/nomacs.sln
  parallel: true
  verbosity: minimal

after_build:
  - copy %CONFIGURATION%\nomacs.exe .

artifacts:
- path: 'build\libavif_vs2019_x64_*.zip'
  name: Static Lib and Includes
- path: 'build\*.exe'
  name: Basic apps
